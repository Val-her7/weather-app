(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))o(a);new MutationObserver(a=>{for(const s of a)if(s.type==="childList")for(const c of s.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&o(c)}).observe(document,{childList:!0,subtree:!0});function n(a){const s={};return a.integrity&&(s.integrity=a.integrity),a.referrerPolicy&&(s.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?s.credentials="include":a.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function o(a){if(a.ep)return;a.ep=!0;const s=n(a);fetch(a.href,s)}})();const y="9e3bac7c0456bd3c8927ed16bb487aee",i=document.getElementById("citySelect");async function T(e){if(e.length<2){i.innerHTML="",i.style.display="none";return}try{const t=await fetch(`https://api.openweathermap.org/geo/1.0/direct?q=${e}&limit=5&appid=${y}`);if(!t.ok)throw new Error("Issue with the GEOLOCADE API...");const n=await t.json();B(n)}catch(t){console.error(t),i.innerHTML="<option>Error while loading suggestions...</option>"}}function I(){const e=i.options.length;e>1?i.size=Math.min(e,5):i.size=1}function B(e){if(i.innerHTML="",e.length===0){const t=document.createElement("option");t.value="No city found...",t.textContent="No city found...",i.appendChild(t),i.style.dislay="block",i.size=1;return}e.forEach(t=>{const n=document.createElement("option");t.state?(n.value=`${t.name} (${t.country}, ${t.state})`,n.textContent=`${t.name} (${t.country}, ${t.state})`):(n.value=`${t.name} (${t.country})`,n.textContent=`${t.name} (${t.country})`),i.appendChild(n),I()}),i.style.display="block"}async function D(e,t,n){try{let o=await fetch(`https://api.openweathermap.org/geo/1.0/direct?q=${e},${t},${n}&appid=${y}`);if(!o.ok)throw new Error("Issue with the GEOLOCADE API...");let a=await o.json();if(a.length===0)throw new Error("Not a valid city name...");return a[0]}catch(o){return console.error(o),null}}async function M(e,t){try{let n=await fetch(`https://api.openweathermap.org/geo/1.0/direct?q=${e},${t}&appid=${y}`);if(!n.ok)throw new Error("Issue with the GEOLOCADE API...");let o=await n.json();if(o.length===0)throw new Error("Not a valid city name...");return o[0]}catch(n){return console.error(n),null}}async function O(e,t,n){let o=await D(e,t,n);if(o){let a=o.lat,s=o.lon;return{lat:a,lon:s}}else return null}async function A(e,t){let n=await M(e,t);if(n){let o=n.lat,a=n.lon;return{lat:o,lon:a}}else return null}async function H(e,t){try{let n=await fetch(`https://api.openweathermap.org/data/2.5/forecast?lat=${e}&lon=${t}&appid=${y}`);if(!n.ok)throw new Error("Issue with the WEATHER API...");return await n.json()}catch(n){return console.error(n),null}}function v(e){let t=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],n=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],o=[],a=document.getElementsByClassName("locations")[0],s=document.createElement("span");s.id=`${e.city.coord.lat}-${e.city.coord.lon}`,s.classList.add("focus"),s.innerHTML=`<p><i class="fa-solid fa-location-dot"></i> ${e.city.name}, ${e.city.country}</p>`,a.prepend(s);let c=document.getElementsByClassName("cities")[0],m=document.createElement("div");m.classList.add("all-days",`${e.city.coord.lat}-${e.city.coord.lon}`),c.prepend(m);for(let r of e.list){let $=new Date(r.dt_txt),l=new Date($.getTime()+e.city.timezone*1e3);if(l.getDate()!==o[0]){o.unshift(l.getDate());let E=document.getElementsByClassName(`${e.city.coord.lat}-${e.city.coord.lon}`)[0],d=document.createElement("div");d.classList.add("weather"),d.innerHTML=`
                <p class="date"><i class="fa-solid fa-calendar-days"></i> ${t[l.getDay()]}, ${l.getDate()}, ${n[l.getMonth()]}, ${l.getFullYear()}</p>
                <div class="hourly-forecast">
                <div class="card">
                    <p>${l.getHours()<10?`0${l.getHours()}:00`:`${l.getHours()}:00`}</p>
                    <p class="pop">${r.pop>0?`${Math.round(r.pop*100)}%`:""}</p>
                    <img src="https://openweathermap.org/img/wn/${r.weather[0].icon}@2x.png" alt="${r.weather[0].description}">
                    <p>${Math.round(r.main.temp-273.15)}&deg;C</p>
                </div>            
                </div>`,E.appendChild(d)}else{let E=document.getElementsByClassName(`${e.city.coord.lat}-${e.city.coord.lon}`)[0].lastElementChild.lastElementChild,d=document.createElement("div");d.classList.add("card"),d.innerHTML=`
            <p>${l.getHours()<10?`0${l.getHours()}:00`:`${l.getHours()}:00`}</p>
            <p class="pop">${r.pop>0?`${Math.round(r.pop*100)}%`:""}</p>
            <img src="https://openweathermap.org/img/wn/${r.weather[0].icon}@2x.png" alt="${r.weather[0].description}">
            <p>${Math.round(r.main.temp-273.15)}&deg;C</p>`,E.appendChild(d)}}let f=document.createElement("div");f.classList.add("chart-container");let g=document.createElement("canvas");g.classList.add("line-chart"),g.height=200,f.prepend(g);let h=document.createElement("p");h.classList.add("title"),h.textContent="5 Days Forecast Chart",m.appendChild(h),m.appendChild(f);let b=e.list,N=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],w=[],C=[];for(let r of b){let $=new Date(r.dt_txt),l=new Date($.getTime()+e.city.timezone*1e3);w.push(`${N[l.getDay()]} ${l.getHours()<10?`0${l.getHours()}:00`:`${l.getHours()}:00`}`),C.push(`${Math.round(r.main.temp-273.15)}`)}Chart.register(ChartDataLabels);let S=document.getElementsByClassName("line-chart")[0];new Chart(S,{type:"line",data:{labels:w,datasets:[{data:C,fill:!0,backgroundColor:"rgb(255, 192, 159)",borderColor:"rgb(236, 110, 76)",pointStyle:"line",tension:.3,datalabels:{align:"bottom",color:"rgb(236, 110, 76)",font:{weight:"bold"},formatter:function(r){return r+"Â°C"}}}]},options:{responsive:!1,maintainAspectRatio:!1,scales:{x:{ticks:{autoSkip:!1,padding:20}},y:{ticks:{display:!1}}},plugins:{legend:{display:!1},datalabels:{display:!0}}}})}function k(e){let t=document.getElementsByClassName("focus")[0];e!==t.id&&(t.classList.replace("focus","unfocus"),document.getElementsByClassName(`${t.id}`)[0].style.display="none",document.getElementById(e).classList.replace("unfocus","focus"),document.getElementsByClassName(e)[0].style.display="block")}function P(e){localStorage.setItem("weather",JSON.stringify(e))}function W(){return JSON.parse(localStorage.getItem("weather"))||[]}const u=document.getElementById("cityInput"),p=document.getElementById("searchCityButton"),L=document.getElementsByClassName("locations")[0];u.addEventListener("keyup",()=>{T(u.value),p.style.visibility="hidden"});i.addEventListener("click",()=>{i.value==="No city found..."?(i.style.display="none",u.value="",p.style.visibility="hidden"):(u.value=i.value,i.style.display="none",p.style.visibility="visible")});p.addEventListener("click",async()=>{let e=u.value.match(/[^(),]+/g).map(c=>c.trim());u.value="",p.style.visibility="hidden";let t;e.length===2&&(t=await A(e[0],e[1])),e.length===3&&(t=await O(e[0],e[1],e[2]));let n=t.lat,o=t.lon,a=await H(n,o);for(let c of L.children)if(c.id===`${a.city.coord.lat}-${a.city.coord.lon}`)return;let s=document.getElementsByClassName("focus")[0];s!==void 0&&(s.classList.replace("focus","unfocus"),document.getElementsByClassName(`${s.id}`)[0].style.display="none",document.getElementsByClassName("all-days")[0].style.display="none"),v(a),P(a)});window.onload=()=>{let e=W();v(e)};L.addEventListener("click",e=>{if(e.target.tagName==="P"){let t=e.target.parentNode.id;k(t)}});
